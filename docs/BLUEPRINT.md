# KAI ERP Connector

## Complete Technical Blueprint

### From SyteLine Data to AI-Ready Tools



```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘   "Hey, what's the welding department working on today?"                      â•‘
â•‘                                                                               â•‘
â•‘                              â†“                                                â•‘
â•‘                                                                               â•‘
â•‘   "WELD-01 has 3 jobs in progress. J-1234 is 45% complete and on schedule.   â•‘
â•‘    J-1235 is behind - only 15% done but was due yesterday. You might want    â•‘
â•‘    to check on that one."                                                     â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```



**Prepared for:** Kaspar Companies  
**Date:** December 2024  
**Version:** 3.0 (Final)



---



# Table of Contents



1. [Executive Summary](#1-executive-summary)
2. [The Complete Picture](#2-the-complete-picture)
3. [Architecture Deep Dive](#3-architecture-deep-dive)
4. [Data Source Layer](#4-data-source-layer)
5. [Connector Layer](#5-connector-layer)
6. [MCP Server Layer](#6-mcp-server-layer)
7. [Bedrock Ops Scheduler](#7-bedrock-ops-scheduler-flagship-connector)
8. [Implementation Roadmap](#8-implementation-roadmap)
9. [Appendices](#9-appendices)



---



# 1. Executive Summary



## The Challenge



Kaspar Companies migrated from SyteLine 8 (on-premises) to SyteLine 10 CloudSuite. This eliminated direct SQL database access that powered production dashboards, operational tools, and reporting across Bedrock Truck Beds, Horizon Firearms, and Circle Y Saddles.



## The Solution



The **KAI ERP Connector** is a three-layer system that:



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚   LAYER 3: MCP SERVER                              â† AI talks here      â”‚
â”‚   Tools that AI agents can discover and use                             â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   LAYER 2: CONNECTORS                              â† Business logic     â”‚
â”‚   Bedrock Scheduler, Sales Orders, Inventory, etc.                      â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   LAYER 1: DATA SOURCES                            â† Complexity hidden  â”‚
â”‚   REST APIs (real-time) + Data Lake (bulk/history)                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## Key Outcomes



| Capability | Before (SL8) | After Migration | With KAI Connector |
|------------|--------------|-----------------|-------------------|
| Real-time production data | âœ… Direct SQL | âŒ Lost | âœ… Restored |
| AI agent access | âŒ None | âŒ None | âœ… Full |
| Query complexity | 1 SQL query | 6+ API calls | 1 tool call |
| Developer experience | Write SQL | Learn Infor APIs | Call endpoint |



## Investment Summary



| Phase | Duration | Deliverable |
|-------|----------|-------------|
| Phase 1 | 2 weeks | Core infrastructure + Bedrock Scheduler |
| Phase 2 | 2 weeks | Additional connectors + Data Lake integration |
| Phase 3 | 1 week | MCP Server + AI agent integration |
| **Total** | **5 weeks** | **Complete AI-ready ERP access** |



---



# 2. The Complete Picture



## 2.1 System Overview



```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                 â•‘
â•‘                              CONSUMERS                                          â•‘
â•‘                                                                                 â•‘
â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â•‘
â•‘    â”‚  Claude  â”‚    â”‚ Bedrock  â”‚    â”‚  Custom  â”‚    â”‚  Future  â”‚               â•‘
â•‘    â”‚    AI    â”‚    â”‚Dashboard â”‚    â”‚  Tools   â”‚    â”‚   Apps   â”‚               â•‘
â•‘    â”‚  Agent   â”‚    â”‚          â”‚    â”‚          â”‚    â”‚          â”‚               â•‘
â•‘    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â•‘
â•‘         â”‚               â”‚               â”‚               â”‚                      â•‘
â•‘         â”‚   MCP         â”‚   REST        â”‚   REST        â”‚                      â•‘
â•‘         â”‚   Protocol    â”‚   API         â”‚   API         â”‚                      â•‘
â•‘         â–¼               â–¼               â–¼               â–¼                      â•‘
â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘    â”‚                                                                     â”‚    â•‘
â•‘    â”‚                      KAI ERP CONNECTOR                              â”‚    â•‘
â•‘    â”‚                                                                     â”‚    â•‘
â•‘    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â•‘
â•‘    â”‚  â”‚                     MCP SERVER                              â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   Tools:                                                    â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   â€¢ get_production_schedule                                 â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   â€¢ get_open_orders                                         â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   â€¢ search_customers                                        â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   â€¢ get_inventory_status                                    â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   â€¢ get_job_details                                         â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â•‘
â•‘    â”‚                             â”‚                                       â”‚    â•‘
â•‘    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â•‘
â•‘    â”‚  â”‚                    CONNECTORS                               â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚    â•‘
â•‘    â”‚  â”‚  â”‚   Bedrock   â”‚ â”‚    Sales    â”‚ â”‚  Inventory  â”‚    ...    â”‚   â”‚    â•‘
â•‘    â”‚  â”‚  â”‚  Ops Sched  â”‚ â”‚   Orders    â”‚ â”‚   Status    â”‚           â”‚   â”‚    â•‘
â•‘    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â•‘
â•‘    â”‚                             â”‚                                       â”‚    â•‘
â•‘    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â•‘
â•‘    â”‚  â”‚                   QUERY ROUTER                              â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   < 5K records + real-time needed? â†’ REST APIs              â”‚   â”‚    â•‘
â•‘    â”‚  â”‚   > 10K records or history?        â†’ Data Lake              â”‚   â”‚    â•‘
â•‘    â”‚  â”‚                                                             â”‚   â”‚    â•‘
â•‘    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â•‘
â•‘    â”‚                  â”‚                         â”‚                        â”‚    â•‘
â•‘    â”‚                  â–¼                         â–¼                        â”‚    â•‘
â•‘    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â•‘
â•‘    â”‚  â”‚    REST API ENGINE     â”‚  â”‚    DATA LAKE ENGINE        â”‚        â”‚    â•‘
â•‘    â”‚  â”‚                        â”‚  â”‚                            â”‚        â”‚    â•‘
â•‘    â”‚  â”‚  â€¢ Token management    â”‚  â”‚  â€¢ Compass SQL             â”‚        â”‚    â•‘
â•‘    â”‚  â”‚  â€¢ Parallel fetch      â”‚  â”‚  â€¢ Bulk extraction         â”‚        â”‚    â•‘
â•‘    â”‚  â”‚  â€¢ DuckDB staging      â”‚  â”‚  â€¢ Historical queries      â”‚        â”‚    â•‘
â•‘    â”‚  â”‚  â€¢ Client-side joins   â”‚  â”‚  â€¢ Server-side joins       â”‚        â”‚    â•‘
â•‘    â”‚  â”‚                        â”‚  â”‚                            â”‚        â”‚    â•‘
â•‘    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â•‘
â•‘    â”‚              â”‚                              â”‚                       â”‚    â•‘
â•‘    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•‘                   â”‚                              â”‚                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¼â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¼â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    â”‚                              â”‚
                    â–¼                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚          â”‚                   â”‚
         â”‚  SYTELINE 10      â”‚          â”‚   INFOR DATA      â”‚
         â”‚  CLOUD            â”‚          â”‚   LAKE            â”‚
         â”‚                   â”‚          â”‚                   â”‚
         â”‚  IDO REST APIs    â”‚          â”‚   Compass SQL     â”‚
         â”‚  (Real-time)      â”‚          â”‚   (10-15 min lag) â”‚
         â”‚                   â”‚          â”‚                   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 2.2 Data Flow Example



**User asks:** "What's running in welding today?"



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: AI RECEIVES QUESTION                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   User: "What's running in welding today?"                                  â”‚
â”‚                                                                             â”‚
â”‚   AI thinks:                                                                â”‚
â”‚   â€¢ This is about production/manufacturing                                  â”‚
â”‚   â€¢ I have a tool called get_production_schedule                            â”‚
â”‚   â€¢ Welding = WELD-01 or WELD-02 work centers                               â”‚
â”‚   â€¢ I should call that tool                                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: MCP TOOL CALL                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   {                                                                         â”‚
â”‚     "tool": "get_production_schedule",                                      â”‚
â”‚     "arguments": {                                                          â”‚
â”‚       "work_center": "WELD-01"                                              â”‚
â”‚     }                                                                       â”‚
â”‚   }                                                                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: CONNECTOR EXECUTES                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   BedrockOpsScheduler:                                                      â”‚
â”‚                                                                             â”‚
â”‚   1. Estimate volume: ~50 operations (small)                                â”‚
â”‚   2. Freshness: Real-time needed                                            â”‚
â”‚   3. Router decision: Use REST APIs                                         â”‚
â”‚                                                                             â”‚
â”‚   4. Parallel fetch 6 IDOs:                                                 â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚      â”‚  SLJobs    â”‚ â”‚SLJobroutes â”‚ â”‚ SLJrtSchs  â”‚                          â”‚
â”‚      â”‚   ~200ms   â”‚ â”‚   ~200ms   â”‚ â”‚   ~200ms   â”‚                          â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚      â”‚  SLItems   â”‚ â”‚SLItemwhses â”‚ â”‚   SLWcs    â”‚                          â”‚
â”‚      â”‚   ~150ms   â”‚ â”‚   ~150ms   â”‚ â”‚   ~100ms   â”‚                          â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                             â”‚
â”‚      Total time: ~400ms (parallel, slowest wins)                            â”‚
â”‚                                                                             â”‚
â”‚   5. Stage in DuckDB, execute JOIN                                          â”‚
â”‚   6. Return structured operations                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: STRUCTURED RESPONSE                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   {                                                                         â”‚
â”‚     "operations": [                                                         â”‚
â”‚       {                                                                     â”‚
â”‚         "job": "J-1234",                                                    â”‚
â”‚         "item": "BED-KING-BLK",                                             â”‚
â”‚         "item_description": "King Bed Frame - Black",                       â”‚
â”‚         "work_center": "WELD-01",                                           â”‚
â”‚         "percent_complete": 45.0,                                           â”‚
â”‚         "schedule": {"start": "06:00", "finish": "14:00"},                  â”‚
â”‚         "status": "on_track"                                                â”‚
â”‚       },                                                                    â”‚
â”‚       {                                                                     â”‚
â”‚         "job": "J-1235",                                                    â”‚
â”‚         "item": "BED-QUEEN-WHT",                                            â”‚
â”‚         "percent_complete": 15.0,                                           â”‚
â”‚         "schedule": {"start": "yesterday", "finish": "yesterday"},          â”‚
â”‚         "status": "behind"                                                  â”‚
â”‚       }                                                                     â”‚
â”‚     ],                                                                      â”‚
â”‚     "summary": {"total": 2, "on_track": 1, "behind": 1}                     â”‚
â”‚   }                                                                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: AI RESPONDS                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   "WELD-01 has 2 jobs running today:                                        â”‚
â”‚                                                                             â”‚
â”‚    â€¢ J-1234 (King Bed Frame - Black) is 45% complete and on track           â”‚
â”‚      to finish by 2 PM                                                      â”‚
â”‚                                                                             â”‚
â”‚    â€¢ J-1235 (Queen Bed Frame - White) is behind schedule - only 15%         â”‚
â”‚      done but was due yesterday. You might want to check on that one."      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



---



# 3. Architecture Deep Dive



## 3.1 The Three-Layer Stack



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  LAYER 3: MCP SERVER                                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                        â”‚
â”‚                                                                             â”‚
â”‚  PURPOSE: Make connectors accessible to AI                                  â”‚
â”‚                                                                             â”‚
â”‚  WHAT IT DOES:                                                              â”‚
â”‚  â€¢ Publishes tool catalog (AI discovers what's available)                   â”‚
â”‚  â€¢ Defines parameters with descriptions (AI knows what to pass)             â”‚
â”‚  â€¢ Validates inputs (catches errors before execution)                       â”‚
â”‚  â€¢ Translates errors (AI-friendly messages)                                 â”‚
â”‚                                                                             â”‚
â”‚  AI SEES:                              AI DOESN'T SEE:                      â”‚
â”‚  âœ“ Tool names                          âœ— REST API details                   â”‚
â”‚  âœ“ Parameter schemas                   âœ— Authentication                     â”‚
â”‚  âœ“ Descriptions of when to use         âœ— Which IDOs to call                 â”‚
â”‚  âœ“ Structured responses                âœ— Join logic                         â”‚
â”‚                                        âœ— REST vs Data Lake routing          â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  LAYER 2: CONNECTORS                                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                        â”‚
â”‚                                                                             â”‚
â”‚  PURPOSE: Encapsulate business logic for each data access pattern           â”‚
â”‚                                                                             â”‚
â”‚  WHAT IT DOES:                                                              â”‚
â”‚  â€¢ Defines which IDOs/tables are needed                                     â”‚
â”‚  â€¢ Specifies join relationships                                             â”‚
â”‚  â€¢ Calculates derived fields (percent complete, status, etc.)               â”‚
â”‚  â€¢ Estimates volume for routing decisions                                   â”‚
â”‚  â€¢ Maps raw data to business objects                                        â”‚
â”‚                                                                             â”‚
â”‚  EACH CONNECTOR DEFINES:               CONNECTORS DON'T HANDLE:             â”‚
â”‚  âœ“ REST query spec (IDOs, props)       âœ— Token management                   â”‚
â”‚  âœ“ Data Lake query (Compass SQL)       âœ— HTTP requests                      â”‚
â”‚  âœ“ Join logic (DuckDB SQL)             âœ— Error retry logic                  â”‚
â”‚  âœ“ Output model (Pydantic)             âœ— Parallel execution                 â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  LAYER 1: DATA SOURCES                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚                                                                             â”‚
â”‚  PURPOSE: Handle raw data access complexity                                 â”‚
â”‚                                                                             â”‚
â”‚  REST API ENGINE:                      DATA LAKE ENGINE:                    â”‚
â”‚  â€¢ OAuth token management              â€¢ ION API authentication             â”‚
â”‚  â€¢ Parallel fetch (asyncio)            â€¢ Compass SQL execution              â”‚
â”‚  â€¢ Rate limit handling                 â€¢ Large result pagination            â”‚
â”‚  â€¢ DuckDB staging & joins              â€¢ Query timeout handling             â”‚
â”‚  â€¢ Retry with backoff                  â€¢ Sync timestamp tracking            â”‚
â”‚                                                                             â”‚
â”‚  BEST FOR:                             BEST FOR:                            â”‚
â”‚  â€¢ Real-time data                      â€¢ Historical analysis                â”‚
â”‚  â€¢ < 5,000 records                     â€¢ > 10,000 records                   â”‚
â”‚  â€¢ Operational queries                 â€¢ Trend reporting                    â”‚
â”‚  â€¢ AI agent lookups                    â€¢ Bulk extracts                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 3.2 Why Three Layers?



| Layer | Changes When... | Example |
|-------|----------------|---------|
| **MCP Server** | AI interface needs to evolve | Add new parameter to tool |
| **Connectors** | Business logic changes | New calculated field |
| **Data Sources** | Infor updates APIs | New authentication method |



**Key insight:** Each layer can change independently. Swap REST for Data Lake? Connectors don't change. Add new tool parameter? Data sources don't change.



---



# 4. Data Source Layer



## 4.1 REST API Engine



### Volume Thresholds



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                         REST API VOLUME GUIDE                               â”‚
â”‚                                                                             â”‚
â”‚   Records    â”‚ Status      â”‚ Action                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   < 500      â”‚ âœ… OPTIMAL  â”‚ Single request, fast response                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   500-2000   â”‚ âœ… GOOD     â”‚ Single request, acceptable latency             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   2000-5000  â”‚ âš ï¸ CAUTION  â”‚ May need pagination, monitor latency          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   5000-10000 â”‚ âš ï¸ EVALUATE â”‚ Consider Data Lake if freshness allows        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   > 10000    â”‚ âŒ TOO MUCH â”‚ Use Data Lake - REST not designed for this    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



### Parallel Fetch Architecture



```python
class RestEngine:
    """
    Fetches from multiple IDOs simultaneously.
    
    Why parallel?
    - Sequential: 6 calls Ã— 400ms = 2.4 seconds
    - Parallel:   6 calls in parallel = ~500ms (slowest wins)
    """
    
    async def parallel_fetch(self, ido_specs: list[IDOSpec]) -> dict:
        # Create all fetch tasks
        tasks = [self._fetch_ido(spec) for spec in ido_specs]
        
        # Execute simultaneously
        results = await asyncio.gather(*tasks)
        
        return dict(zip([s.name for s in ido_specs], results))
```



```
PARALLEL FETCH VISUALIZATION:

Time â†’  0ms    100ms   200ms   300ms   400ms   500ms
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLJobs  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (400ms)
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLJobrt â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  (450ms) â† Slowest
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLJrtSc â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (350ms)
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLItems â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (250ms)
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLItemW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (300ms)
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
SLWcs   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (200ms)
        â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                    All data ready: 450ms
```



### DuckDB Staging Layer



```
WHY DUCKDB?

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                            â”‚
â”‚  The Problem: SyteLine returns data from separate IDOs                     â”‚
â”‚                                                                            â”‚
â”‚  SLJobs returns:        SLJobroutes returns:     SLItems returns:          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Job  â”‚ Item     â”‚    â”‚ Job â”‚ Wc   â”‚ Qty â”‚     â”‚ Item  â”‚ Desc    â”‚       â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚       â”‚
â”‚  â”‚ 1234 â”‚ BED-KING â”‚    â”‚1234 â”‚WELD-1â”‚ 50  â”‚     â”‚BED-KNGâ”‚King Bed â”‚       â”‚
â”‚  â”‚ 1235 â”‚ BED-QUEN â”‚    â”‚1234 â”‚PAINT â”‚ 50  â”‚     â”‚BED-QN â”‚Queen Bedâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚1235 â”‚WELD-1â”‚ 30  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                            â”‚
â”‚  We need to JOIN these to get usable data                                  â”‚
â”‚                                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  The Solution: Stage in DuckDB, join with SQL                              â”‚
â”‚                                                                            â”‚
â”‚  1. Load each IDO response into a DuckDB table                             â”‚
â”‚  2. Execute JOIN query (same SQL you'd write for direct DB access)         â”‚
â”‚  3. Return combined results                                                â”‚
â”‚  4. DuckDB instance is discarded (in-memory, ephemeral)                    â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                                                                  â”‚      â”‚
â”‚  â”‚  SELECT j.Job, j.Item, i.Description, jr.Wc, jr.Qty             â”‚      â”‚
â”‚  â”‚  FROM jobs j                                                     â”‚      â”‚
â”‚  â”‚  JOIN jobroutes jr ON j.Job = jr.Job                            â”‚      â”‚
â”‚  â”‚  JOIN items i ON j.Item = i.Item                                â”‚      â”‚
â”‚  â”‚                                                                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                            â”‚
â”‚  Result:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Job  â”‚ Item     â”‚ Description â”‚ Wc     â”‚ Qty â”‚          â”‚               â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚          â”‚               â”‚
â”‚  â”‚ 1234 â”‚ BED-KING â”‚ King Bed    â”‚ WELD-1 â”‚ 50  â”‚  â† Ready â”‚               â”‚
â”‚  â”‚ 1234 â”‚ BED-KING â”‚ King Bed    â”‚ PAINT  â”‚ 50  â”‚    to    â”‚               â”‚
â”‚  â”‚ 1235 â”‚ BED-QUEN â”‚ Queen Bed   â”‚ WELD-1 â”‚ 30  â”‚    use!  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 4.2 Data Lake Engine



### When to Use Data Lake



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                    DATA SOURCE DECISION MATRIX                              â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚                         DATA FRESHNESS REQUIREMENT                          â”‚
â”‚                                                                             â”‚
â”‚                    Real-time      Near-RT       Batch OK                    â”‚
â”‚                    (seconds)     (minutes)      (hours)                     â”‚
â”‚                         â”‚            â”‚             â”‚                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚  < 500  â”‚   REST API    â”‚  REST API  â”‚   Either   â”‚              â”‚        â”‚
â”‚         â”‚      âœ…        â”‚     âœ…      â”‚     âœ…      â”‚              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚ VOLUME  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚  500-   â”‚   REST API    â”‚  REST API  â”‚  Data Lake â”‚              â”‚        â”‚
â”‚  5000   â”‚      âœ…        â”‚     âœ…      â”‚     âœ…      â”‚              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚  5K-    â”‚   Evaluate    â”‚ Data Lake  â”‚  Data Lake â”‚              â”‚        â”‚
â”‚  10K    â”‚      âš ï¸        â”‚     âœ…      â”‚     âœ…      â”‚              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚  > 10K  â”‚   Stream*     â”‚ Data Lake  â”‚  Data Lake â”‚              â”‚        â”‚
â”‚         â”‚      ğŸ’°        â”‚     âœ…      â”‚     âœ…      â”‚              â”‚        â”‚
â”‚         â”‚               â”‚            â”‚             â”‚              â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚        â”‚
â”‚                                                                             â”‚
â”‚  * Stream Pipelines requires additional licensing                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



### Data Lake Limitations



```
âš ï¸  IMPORTANT: DATA LAKE CONSTRAINTS

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  1. SYNC DELAY: 10-15 minutes minimum                                       â”‚
â”‚     Data Lake is NOT real-time. A job completed 5 minutes ago               â”‚
â”‚     may not appear yet.                                                     â”‚
â”‚                                                                             â”‚
â”‚  2. LIMITED TABLES: Not everything replicates                               â”‚
â”‚     Only tables in DATALAKE replication category are available.             â”‚
â”‚     Custom tables may not be included.                                      â”‚
â”‚                                                                             â”‚
â”‚  3. ADDITIONAL LICENSING: Not included in base CloudSuite                   â”‚
â”‚     Data Fabric add-on required. Stream Pipelines costs extra.              â”‚
â”‚                                                                             â”‚
â”‚  4. QUERY LIMITS: 60-minute timeout, 100K rows per page                     â”‚
â”‚     Very complex queries may fail.                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RECOMMENDATION: Start with REST APIs (included, real-time, sufficient for 
most operational use cases). Add Data Lake when specific analytical 
requirements demand it.
```



---



# 5. Connector Layer



## 5.1 Connector Pattern



Each connector is a self-contained module that defines a complete data access pattern:



```python
class BaseConnector(ABC):
    """
    Base class for all KAI ERP Connectors.
    
    Each connector encapsulates:
    - Which data sources to fetch
    - How to join/transform the data
    - What business object to return
    """
    
    @abstractmethod
    def get_rest_spec(self) -> RestQuerySpec:
        """Define REST API access pattern."""
        pass
    
    @abstractmethod
    def get_lake_query(self) -> str:
        """Define Data Lake SQL query."""
        pass
    
    @abstractmethod
    def estimate_volume(self, filters: dict) -> int:
        """Estimate result count for routing."""
        pass
    
    async def execute(
        self, 
        filters: dict = None,
        freshness: Freshness = Freshness.REALTIME
    ) -> ConnectorResult:
        """
        Execute query via optimal data source.
        
        The connector doesn't decide REST vs Data Lake - 
        the query router does, based on volume and freshness.
        """
        volume = await self.estimate_volume(filters)
        source = self.router.select_source(volume, freshness)
        
        if source == DataSource.REST:
            return await self._execute_rest(filters)
        else:
            return await self._execute_lake(filters)
```



## 5.2 Connector Inventory



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                         CONNECTOR INVENTORY                                 â”‚
â”‚                                                                             â”‚
â”‚  PHASE 1 (Core)                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ BEDROCK OPS SCHEDULER                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚ Purpose:  Production schedule visibility                            â”‚   â”‚
â”‚  â”‚ Sources:  SLJobs, SLJobroutes, SLJrtSchs, SLItems, SLItemwhses,    â”‚   â”‚
â”‚  â”‚           SLWcs                                                     â”‚   â”‚
â”‚  â”‚ Volume:   300-800 operations (typical)                              â”‚   â”‚
â”‚  â”‚ Route:    REST API (real-time)                                      â”‚   â”‚
â”‚  â”‚ Tool:     get_production_schedule                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  PHASE 2 (Extended)                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ SALES ORDER TRACKER                                                 â”‚   â”‚
â”‚  â”‚ Purpose:  Open orders and backlog visibility                        â”‚   â”‚
â”‚  â”‚ Sources:  SLCos, SLCoitems, SLCustomers, SLItems                    â”‚   â”‚
â”‚  â”‚ Volume:   500-2000 orders                                           â”‚   â”‚
â”‚  â”‚ Route:    REST API (real-time)                                      â”‚   â”‚
â”‚  â”‚ Tool:     get_open_orders                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CUSTOMER SEARCH                                                     â”‚   â”‚
â”‚  â”‚ Purpose:  Find customers by name, location, etc.                    â”‚   â”‚
â”‚  â”‚ Sources:  SLCustomers, SLCustaddrs                                  â”‚   â”‚
â”‚  â”‚ Volume:   10-100 matches                                            â”‚   â”‚
â”‚  â”‚ Route:    REST API (real-time)                                      â”‚   â”‚
â”‚  â”‚ Tool:     search_customers                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ INVENTORY STATUS                                                    â”‚   â”‚
â”‚  â”‚ Purpose:  Stock levels and availability                             â”‚   â”‚
â”‚  â”‚ Sources:  SLItems, SLItemwhses, SLItemlocs                          â”‚   â”‚
â”‚  â”‚ Volume:   100-5000 items                                            â”‚   â”‚
â”‚  â”‚ Route:    REST API (typical) / Data Lake (full catalog)             â”‚   â”‚
â”‚  â”‚ Tool:     get_inventory_status                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  PHASE 3 (Analytics) - Requires Data Lake                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ORDER HISTORY                                                       â”‚   â”‚
â”‚  â”‚ Purpose:  Historical order analysis                                 â”‚   â”‚
â”‚  â”‚ Route:    Data Lake only (bulk historical data)                     â”‚   â”‚
â”‚  â”‚ Tool:     get_order_history                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ AP/AR AGING                                                         â”‚   â”‚
â”‚  â”‚ Purpose:  Accounts payable/receivable aging                         â”‚   â”‚
â”‚  â”‚ Route:    Data Lake only (financial reporting)                      â”‚   â”‚
â”‚  â”‚ Tool:     get_aging_report                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



---



# 6. MCP Server Layer



## 6.1 What MCP Does



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                    MCP: THE AI-READY INTERFACE                              â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  WITHOUT MCP                           WITH MCP                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚                                                                             â”‚
â”‚  AI needs to know:                     AI needs to know:                    â”‚
â”‚                                                                             â”‚
â”‚  â€¢ REST API authentication             â€¢ Tool name                          â”‚
â”‚  â€¢ Which 6 IDOs to call                â€¢ Parameters (typed, described)      â”‚
â”‚  â€¢ Property names for each             â€¢ When to use it (description)       â”‚
â”‚  â€¢ How to construct URLs                                                    â”‚
â”‚  â€¢ How to handle pagination                                                 â”‚
â”‚  â€¢ How to join the results                                                  â”‚
â”‚  â€¢ Rate limit handling                                                      â”‚
â”‚  â€¢ Token refresh logic                                                      â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  AI SEES THIS:                                                              â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                                   â”‚     â”‚
â”‚  â”‚  Tool: get_production_schedule                                    â”‚     â”‚
â”‚  â”‚                                                                   â”‚     â”‚
â”‚  â”‚  Description: Get current production schedule for Bedrock.        â”‚     â”‚
â”‚  â”‚  Use when user asks about what's being manufactured,              â”‚     â”‚
â”‚  â”‚  production status, or work center schedules.                     â”‚     â”‚
â”‚  â”‚                                                                   â”‚     â”‚
â”‚  â”‚  Parameters:                                                      â”‚     â”‚
â”‚  â”‚    â€¢ work_center (string): Filter by work center code             â”‚     â”‚
â”‚  â”‚    â€¢ job (string): Filter by job number                           â”‚     â”‚
â”‚  â”‚    â€¢ include_completed (bool): Include done operations            â”‚     â”‚
â”‚  â”‚                                                                   â”‚     â”‚
â”‚  â”‚  Returns: List of operations with job details                     â”‚     â”‚
â”‚  â”‚                                                                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  That's it. One tool. Three parameters. Clear description.                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 6.2 Tool Definitions



```python
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                           MCP TOOL DEFINITIONS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRODUCTION_SCHEDULE_TOOL = Tool(
    name="get_production_schedule",
    
    description="""
    Get current production schedule for Bedrock manufacturing operations.
    
    Returns scheduled operations showing what's being manufactured, where,
    and progress status.
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ USE THIS WHEN:                                                 â”‚
    â”‚ â€¢ User asks what's being manufactured/produced                 â”‚
    â”‚ â€¢ User asks about production status or progress                â”‚
    â”‚ â€¢ User asks what's scheduled for a work center                 â”‚
    â”‚ â€¢ User asks about job completion percentages                   â”‚
    â”‚ â€¢ User asks what's running on the shop floor                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DON'T USE FOR:                                                 â”‚
    â”‚ â€¢ Sales orders â†’ use get_open_orders                           â”‚
    â”‚ â€¢ Customer info â†’ use search_customers                         â”‚
    â”‚ â€¢ Inventory levels â†’ use get_inventory_status                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    Common work centers: WELD-01, WELD-02, PAINT-01, ASSY-01, PACK-01
    """,
    
    parameters=[
        Parameter(
            name="work_center",
            type="string",
            required=False,
            description="Work center code (e.g., 'WELD-01'). Omit for all."
        ),
        Parameter(
            name="job",
            type="string",
            required=False,
            description="Job number (e.g., 'J-12345'). Omit for all jobs."
        ),
        Parameter(
            name="include_completed",
            type="boolean",
            required=False,
            default=False,
            description="Include 100% complete operations. Default: false."
        )
    ]
)

OPEN_ORDERS_TOOL = Tool(
    name="get_open_orders",
    
    description="""
    Get open sales orders that haven't shipped yet.
    
    Returns customer orders with line items, quantities, and due dates.
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ USE THIS WHEN:                                                 â”‚
    â”‚ â€¢ User asks about open orders or backlog                       â”‚
    â”‚ â€¢ User asks what needs to ship                                 â”‚
    â”‚ â€¢ User asks about a customer's orders                          â”‚
    â”‚ â€¢ User asks about orders due soon                              â”‚
    â”‚ â€¢ User asks about late/overdue orders                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    """,
    
    parameters=[
        Parameter(
            name="customer",
            type="string",
            required=False,
            description="Customer name or number. Partial match supported."
        ),
        Parameter(
            name="days_out",
            type="integer",
            required=False,
            description="Only orders due within N days. E.g., 7 for this week."
        )
    ]
)

CUSTOMER_SEARCH_TOOL = Tool(
    name="search_customers",
    
    description="""
    Search for customer information.
    
    Returns customer details including contact info and account status.
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ USE THIS WHEN:                                                 â”‚
    â”‚ â€¢ User asks about a specific customer                          â”‚
    â”‚ â€¢ User needs customer contact info                             â”‚
    â”‚ â€¢ User asks to find customers by location                      â”‚
    â”‚ â€¢ User needs a customer number for another query               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    NOTE: To see customer orders, first search here, then use
    get_open_orders with the customer number.
    """,
    
    parameters=[
        Parameter(
            name="query",
            type="string",
            required=True,
            description="Search term: name, number, city, or state."
        ),
        Parameter(
            name="active_only",
            type="boolean",
            required=False,
            default=True,
            description="Only active customers. False includes inactive."
        )
    ]
)

INVENTORY_STATUS_TOOL = Tool(
    name="get_inventory_status",
    
    description="""
    Get current inventory levels.
    
    Returns quantity on hand, available, and location info.
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ USE THIS WHEN:                                                 â”‚
    â”‚ â€¢ User asks about stock levels                                 â”‚
    â”‚ â€¢ User asks if something is in stock                           â”‚
    â”‚ â€¢ User asks about inventory availability                       â”‚
    â”‚ â€¢ User asks where items are located                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    NOTE: For items being manufactured, use get_production_schedule.
    """,
    
    parameters=[
        Parameter(
            name="item",
            type="string",
            required=False,
            description="Item number. Omit for all (may be slow)."
        ),
        Parameter(
            name="warehouse",
            type="string",
            required=False,
            description="Warehouse code. Omit for all locations."
        ),
        Parameter(
            name="low_stock_only",
            type="boolean",
            required=False,
            default=False,
            description="Only items below reorder point."
        )
    ]
)
```



## 6.3 MCP Server Implementation



```python
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                           MCP SERVER
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

from mcp import Server
from kai_erp.connectors import (
    BedrockOpsScheduler,
    SalesOrderTracker,
    CustomerSearch,
    InventoryStatus
)

class KaiErpMcpServer(Server):
    """
    MCP Server for KAI ERP Connector.
    
    This is the layer that makes ERP data "AI-Ready".
    """
    
    def __init__(self, config: Config):
        super().__init__(
            name="kai-erp",
            version="3.0.0"
        )
        
        # Initialize shared engines
        self.rest_engine = RestEngine(config)
        self.lake_engine = DataLakeEngine(config) if config.lake_enabled else None
        
        # Register tools
        self.register_tool(PRODUCTION_SCHEDULE_TOOL, self._handle_production_schedule)
        self.register_tool(OPEN_ORDERS_TOOL, self._handle_open_orders)
        self.register_tool(CUSTOMER_SEARCH_TOOL, self._handle_customer_search)
        self.register_tool(INVENTORY_STATUS_TOOL, self._handle_inventory_status)
    
    async def _handle_production_schedule(
        self,
        work_center: str = None,
        job: str = None,
        include_completed: bool = False
    ) -> ToolResult:
        """Bridge MCP call to BedrockOpsScheduler connector."""
        
        connector = BedrockOpsScheduler(self.rest_engine, self.lake_engine)
        
        try:
            result = await connector.execute(
                filters={
                    "work_center": work_center,
                    "job": job,
                    "include_completed": include_completed
                }
            )
            
            return ToolResult(
                success=True,
                data={
                    "operations": result.data,
                    "summary": {
                        "total": len(result.data),
                        "data_source": result.source.value,
                        "query_ms": result.latency_ms
                    }
                }
            )
            
        except VolumeExceedsLimit as e:
            return ToolResult(
                success=False,
                error={
                    "message": str(e),
                    "suggestion": "Add a work_center or job filter to reduce results."
                }
            )
```



---



# 7. Bedrock Ops Scheduler (Flagship Connector)



## 7.1 Complete Specification



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                    BEDROCK OPS SCHEDULER                                    â”‚
â”‚                    Flagship Connector                                       â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  PURPOSE                                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚  Provide real-time visibility into Bedrock Truck Beds production            â”‚
â”‚  operations. Replaces direct SQL queries from SL8.                          â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SOURCE IDOs                                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ IDO          â”‚ Purpose                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ SLJobs       â”‚ Job headers: item, qty, status                       â”‚   â”‚
â”‚  â”‚ SLJobroutes  â”‚ Operations: work center, sequence, progress          â”‚   â”‚
â”‚  â”‚ SLJrtSchs    â”‚ Schedule: start/finish dates per operation           â”‚   â”‚
â”‚  â”‚ SLItems      â”‚ Item master: descriptions                            â”‚   â”‚
â”‚  â”‚ SLItemwhses  â”‚ Inventory: qty on hand                               â”‚   â”‚
â”‚  â”‚ SLWcs        â”‚ Work centers: descriptions                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  VOLUME PROFILE                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚  Typical active jobs:       100-300                                         â”‚
â”‚  Operations per job:        3-8                                             â”‚
â”‚  Total operations:          300-800 (typical)                               â”‚
â”‚  Maximum expected:          2,000 (peak season)                             â”‚
â”‚                                                                             â”‚
â”‚  VERDICT: Well within REST API sweet spot âœ…                                â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  FILTERS                                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚                                                                             â”‚
â”‚  â€¢ work_center: Filter to single work center (e.g., "WELD-01")             â”‚
â”‚  â€¢ job: Filter to single job number                                         â”‚
â”‚  â€¢ include_completed: Show 100% complete operations (default: false)        â”‚
â”‚  â€¢ date_range: Filter by schedule date (future enhancement)                 â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  OUTPUT MODEL                                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                               â”‚
â”‚                                                                             â”‚
â”‚  ScheduledOperation:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ job: str                    # "J-12345"                             â”‚   â”‚
â”‚  â”‚ suffix: int                 # 0                                     â”‚   â”‚
â”‚  â”‚ item: str                   # "BED-KING-BLK"                        â”‚   â”‚
â”‚  â”‚ item_description: str       # "King Bed Frame - Black"              â”‚   â”‚
â”‚  â”‚ operation_num: int          # 20                                    â”‚   â”‚
â”‚  â”‚ work_center: str            # "WELD-01"                             â”‚   â”‚
â”‚  â”‚ work_center_description: str # "Welding Station 1"                  â”‚   â”‚
â”‚  â”‚ qty_released: float         # 50                                    â”‚   â”‚
â”‚  â”‚ qty_complete: float         # 23                                    â”‚   â”‚
â”‚  â”‚ pct_complete: float         # 46.0                                  â”‚   â”‚
â”‚  â”‚ sched_start: datetime       # 2024-12-09T06:00:00                   â”‚   â”‚
â”‚  â”‚ sched_finish: datetime      # 2024-12-09T14:00:00                   â”‚   â”‚
â”‚  â”‚ status: str                 # "on_track" | "behind" | "complete"    â”‚   â”‚
â”‚  â”‚ qty_on_hand: float          # 12 (inventory of finished item)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 7.2 Implementation



```python
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                    BEDROCK OPS SCHEDULER CONNECTOR
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class BedrockOpsScheduler(BaseConnector):
    """
    Production schedule connector for Bedrock operations.
    
    This is the flagship connector that builds the foundation for all others.
    """
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # REST API SPECIFICATION
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    def get_rest_spec(self) -> RestQuerySpec:
        return RestQuerySpec(
            idos=[
                IDOSpec(
                    name="SLJobs",
                    properties=[
                        "Job", "Suffix", "Item", "QtyReleased", 
                        "QtyComplete", "Stat", "Whse"
                    ],
                    filter="Stat='R'"  # Released jobs only
                ),
                IDOSpec(
                    name="SLJobroutes",
                    properties=[
                        "Job", "Suffix", "OperNum", "Wc",
                        "QtyComplete", "QtyScrapped"
                    ]
                ),
                IDOSpec(
                    name="SLJrtSchs",
                    properties=[
                        "Job", "Suffix", "OperNum",
                        "SchedStart", "SchedFinish"
                    ]
                ),
                IDOSpec(
                    name="SLItems",
                    properties=["Item", "Description"]
                ),
                IDOSpec(
                    name="SLItemwhses",
                    properties=["Item", "Whse", "QtyOnHand"]
                ),
                IDOSpec(
                    name="SLWcs",
                    properties=["Wc", "Description"]
                )
            ],
            
            join_sql="""
                SELECT 
                    j.Job,
                    j.Suffix,
                    j.Item,
                    j.QtyReleased,
                    j.QtyComplete as JobQtyComplete,
                    jr.OperNum,
                    jr.Wc,
                    jr.QtyComplete as OperQtyComplete,
                    jr.QtyScrapped,
                    js.SchedStart,
                    js.SchedFinish,
                    i.Description as ItemDescription,
                    iw.QtyOnHand,
                    wc.Description as WcDescription,
                    
                    -- Calculated: percent complete
                    CASE 
                        WHEN j.QtyReleased > 0 
                        THEN ROUND((jr.QtyComplete / j.QtyReleased) * 100, 1)
                        ELSE 0 
                    END as PctComplete,
                    
                    -- Calculated: status
                    CASE
                        WHEN jr.QtyComplete >= j.QtyReleased THEN 'complete'
                        WHEN js.SchedFinish < CURRENT_TIMESTAMP THEN 'behind'
                        ELSE 'on_track'
                    END as Status
                    
                FROM SLJobs j
                JOIN SLJobroutes jr 
                    ON j.Job = jr.Job AND j.Suffix = jr.Suffix
                LEFT JOIN SLJrtSchs js 
                    ON jr.Job = js.Job 
                    AND jr.Suffix = js.Suffix 
                    AND jr.OperNum = js.OperNum
                LEFT JOIN SLItems i 
                    ON j.Item = i.Item
                LEFT JOIN SLItemwhses iw 
                    ON j.Item = iw.Item AND j.Whse = iw.Whse
                LEFT JOIN SLWcs wc 
                    ON jr.Wc = wc.Wc
                    
                ORDER BY js.SchedStart, j.Job, jr.OperNum
            """
        )
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # DATA LAKE SPECIFICATION (for bulk/historical access)
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    def get_lake_query(self) -> str:
        return """
            SELECT 
                j.job as Job,
                j.suffix as Suffix,
                j.item as Item,
                j.qty_released as QtyReleased,
                j.qty_complete as JobQtyComplete,
                jr.oper_num as OperNum,
                jr.wc as Wc,
                jr.qty_complete as OperQtyComplete,
                js.sched_start as SchedStart,
                js.sched_finish as SchedFinish,
                i.description as ItemDescription,
                iw.qty_on_hand as QtyOnHand,
                wc.description as WcDescription
                
            FROM SYTELINE.job j
            JOIN SYTELINE.jobroute jr 
                ON j.job = jr.job AND j.suffix = jr.suffix
            LEFT JOIN SYTELINE.jrt_sch js 
                ON jr.job = js.job 
                AND jr.suffix = js.suffix 
                AND jr.oper_num = js.oper_num
            LEFT JOIN SYTELINE.item i 
                ON j.item = i.item
            LEFT JOIN SYTELINE.itemwhse iw 
                ON j.item = iw.item AND j.whse = iw.whse
            LEFT JOIN SYTELINE.wc wc 
                ON jr.wc = wc.wc
                
            WHERE j.stat = 'R'
            ORDER BY js.sched_start, j.job, jr.oper_num
        """
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # VOLUME ESTIMATION
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    TYPICAL_ACTIVE_JOBS = 200
    TYPICAL_OPS_PER_JOB = 4
    
    async def estimate_volume(self, filters: dict) -> int:
        base = self.TYPICAL_ACTIVE_JOBS * self.TYPICAL_OPS_PER_JOB  # ~800
        
        if filters:
            if filters.get("work_center"):
                return base // 10  # ~80 ops per work center
            if filters.get("job"):
                return self.TYPICAL_OPS_PER_JOB  # ~4 ops
        
        return base
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # OUTPUT TRANSFORMATION
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    def transform_result(self, row: dict) -> ScheduledOperation:
        return ScheduledOperation(
            job=row["Job"],
            suffix=row["Suffix"],
            item=row["Item"],
            item_description=row.get("ItemDescription", ""),
            operation_num=row["OperNum"],
            work_center=row["Wc"],
            work_center_description=row.get("WcDescription", ""),
            qty_released=row["QtyReleased"],
            qty_complete=row["OperQtyComplete"],
            pct_complete=row.get("PctComplete", 0),
            sched_start=row.get("SchedStart"),
            sched_finish=row.get("SchedFinish"),
            status=row.get("Status", "unknown"),
            qty_on_hand=row.get("QtyOnHand")
        )
```



---



# 8. Implementation Roadmap



## 8.1 Phase Overview



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                        IMPLEMENTATION TIMELINE                              â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  Week 1        Week 2        Week 3        Week 4        Week 5            â”‚
â”‚    â”‚             â”‚             â”‚             â”‚             â”‚                â”‚
â”‚    â–¼             â–¼             â–¼             â–¼             â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚  â”‚      PHASE 1            â”‚                                                â”‚
â”‚  â”‚   Core + Bedrock        â”‚                                                â”‚
â”‚  â”‚                         â”‚                                                â”‚
â”‚  â”‚  â€¢ REST Engine          â”‚                                                â”‚
â”‚  â”‚  â€¢ Auth/Token mgmt      â”‚                                                â”‚
â”‚  â”‚  â€¢ Parallel fetch       â”‚                                                â”‚
â”‚  â”‚  â€¢ DuckDB staging       â”‚                                                â”‚
â”‚  â”‚  â€¢ Bedrock connector    â”‚                                                â”‚
â”‚  â”‚  â€¢ FastAPI endpoints    â”‚                                                â”‚
â”‚  â”‚                         â”‚                                                â”‚
â”‚  â”‚  DELIVERABLE:           â”‚                                                â”‚
â”‚  â”‚  Production schedule    â”‚                                                â”‚
â”‚  â”‚  via REST API           â”‚                                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚                    â”‚                                                        â”‚
â”‚                    â–¼                                                        â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚              â”‚      PHASE 2            â”‚                                    â”‚
â”‚              â”‚   More Connectors       â”‚                                    â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â”‚  â€¢ Sales Order Tracker  â”‚                                    â”‚
â”‚              â”‚  â€¢ Customer Search      â”‚                                    â”‚
â”‚              â”‚  â€¢ Inventory Status     â”‚                                    â”‚
â”‚              â”‚  â€¢ Data Lake engine     â”‚                                    â”‚
â”‚              â”‚    (if licensed)        â”‚                                    â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â”‚  DELIVERABLE:           â”‚                                    â”‚
â”‚              â”‚  Full connector suite   â”‚                                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                        â”‚      PHASE 3            â”‚                          â”‚
â”‚                        â”‚   MCP + AI Ready        â”‚                          â”‚
â”‚                        â”‚                         â”‚                          â”‚
â”‚                        â”‚  â€¢ MCP Server           â”‚                          â”‚
â”‚                        â”‚  â€¢ Tool definitions     â”‚                          â”‚
â”‚                        â”‚  â€¢ Tool handlers        â”‚                          â”‚
â”‚                        â”‚  â€¢ AI testing           â”‚                          â”‚
â”‚                        â”‚                         â”‚                          â”‚
â”‚                        â”‚  DELIVERABLE:           â”‚                          â”‚
â”‚                        â”‚  AI agents can query    â”‚                          â”‚
â”‚                        â”‚  ERP data               â”‚                          â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 8.2 Phase 1 Detail: Core + Bedrock (Weeks 1-2)



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: CORE INFRASTRUCTURE + BEDROCK SCHEDULER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  DAY 1-2: Project Setup                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  â–¡ Repository initialization                                                â”‚
â”‚  â–¡ Docker/Coolify configuration                                             â”‚
â”‚  â–¡ Environment setup (.env, secrets)                                        â”‚
â”‚  â–¡ Validate SL10 credentials via Postman                                    â”‚
â”‚                                                                             â”‚
â”‚  DAY 3-4: Authentication Layer                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â–¡ Token acquisition from SL10                                              â”‚
â”‚  â–¡ Token caching with expiry tracking                                       â”‚
â”‚  â–¡ Automatic refresh at 55 minutes                                          â”‚
â”‚  â–¡ Error handling (401 retry)                                               â”‚
â”‚                                                                             â”‚
â”‚  DAY 5-6: REST API Engine                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â–¡ HTTP client with connection pooling                                      â”‚
â”‚  â–¡ Parallel fetch (asyncio.gather)                                          â”‚
â”‚  â–¡ Rate limit handling (429 backoff)                                        â”‚
â”‚  â–¡ Response parsing                                                         â”‚
â”‚                                                                             â”‚
â”‚  DAY 7-8: Staging Layer                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  â–¡ DuckDB integration                                                       â”‚
â”‚  â–¡ JSON â†’ DataFrame â†’ Table loading                                         â”‚
â”‚  â–¡ SQL query execution                                                      â”‚
â”‚  â–¡ Result extraction                                                        â”‚
â”‚                                                                             â”‚
â”‚  DAY 9-10: Bedrock Connector + API                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  â–¡ BedrockOpsScheduler connector                                            â”‚
â”‚  â–¡ FastAPI endpoints                                                        â”‚
â”‚  â–¡ OpenAPI documentation                                                    â”‚
â”‚  â–¡ Integration testing                                                      â”‚
â”‚  â–¡ Deploy to KAI server                                                     â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  PHASE 1 EXIT CRITERIA:                                                     â”‚
â”‚  âœ“ GET /bedrock/schedule returns production data                            â”‚
â”‚  âœ“ Response time < 2 seconds                                                â”‚
â”‚  âœ“ Data matches SL8 query results (spot check 10 jobs)                      â”‚
â”‚  âœ“ Filters work (work_center, job)                                          â”‚
â”‚  âœ“ Container stable for 24+ hours                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## 8.3 Phase 3 Detail: MCP Integration (Week 5)



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: MCP SERVER + AI INTEGRATION                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  DAY 1-2: MCP Server Framework                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  â–¡ MCP server initialization                                                â”‚
â”‚  â–¡ Tool registry                                                            â”‚
â”‚  â–¡ Protocol handling                                                        â”‚
â”‚  â–¡ Error translation layer                                                  â”‚
â”‚                                                                             â”‚
â”‚  DAY 3-4: Tool Implementation                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â–¡ get_production_schedule tool                                             â”‚
â”‚  â–¡ get_open_orders tool                                                     â”‚
â”‚  â–¡ search_customers tool                                                    â”‚
â”‚  â–¡ get_inventory_status tool                                                â”‚
â”‚  â–¡ Handler functions bridging to connectors                                 â”‚
â”‚                                                                             â”‚
â”‚  DAY 5: Testing + Documentation                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â–¡ Test with Claude Desktop                                                 â”‚
â”‚  â–¡ Verify tool discovery                                                    â”‚
â”‚  â–¡ Test multi-tool conversations                                            â”‚
â”‚  â–¡ Document example prompts                                                 â”‚
â”‚  â–¡ Create AI user guide                                                     â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  PHASE 3 EXIT CRITERIA:                                                     â”‚
â”‚  âœ“ AI can discover all tools via MCP                                        â”‚
â”‚  âœ“ "What's running in welding?" returns correct data                        â”‚
â”‚  âœ“ Multi-step queries work (find customer â†’ get their orders)               â”‚
â”‚  âœ“ Errors produce helpful AI-friendly messages                              â”‚
â”‚  âœ“ Documentation complete for AI users                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



---



# 9. Appendices



## 9.1 Project Structure



```
kai-erp-connector/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ src/kai_erp/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                      # Layer 1: Data Sources
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py               # Token management
â”‚   â”‚   â”œâ”€â”€ rest_engine.py        # REST API client
â”‚   â”‚   â”œâ”€â”€ lake_engine.py        # Data Lake client
â”‚   â”‚   â”œâ”€â”€ staging.py            # DuckDB staging
â”‚   â”‚   â””â”€â”€ router.py             # REST vs Lake routing
â”‚   â”‚
â”‚   â”œâ”€â”€ connectors/                # Layer 2: Business Logic
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py               # BaseConnector class
â”‚   â”‚   â”œâ”€â”€ bedrock_ops.py        # Production schedule
â”‚   â”‚   â”œâ”€â”€ sales_orders.py       # Open orders
â”‚   â”‚   â”œâ”€â”€ customers.py          # Customer search
â”‚   â”‚   â””â”€â”€ inventory.py          # Inventory status
â”‚   â”‚
â”‚   â”œâ”€â”€ mcp/                       # Layer 3: AI Interface
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ server.py             # MCP server
â”‚   â”‚   â”œâ”€â”€ tools.py              # Tool definitions
â”‚   â”‚   â””â”€â”€ handlers.py           # Tool handlers
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                    # Shared data models
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ operations.py
â”‚   â”‚   â”œâ”€â”€ orders.py
â”‚   â”‚   â””â”€â”€ customers.py
â”‚   â”‚
â”‚   â””â”€â”€ api/                       # REST API (for non-AI consumers)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py
â”‚       â””â”€â”€ routes/
â”‚           â”œâ”€â”€ bedrock.py
â”‚           â”œâ”€â”€ sales.py
â”‚           â””â”€â”€ inventory.py
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ conftest.py
    â”œâ”€â”€ test_core/
    â”œâ”€â”€ test_connectors/
    â””â”€â”€ test_mcp/
```



## 9.2 Environment Configuration



```bash
# .env.example

# SyteLine 10 REST API
SL10_BASE_URL=https://xxx.erpsl.inforcloudsuite.com
SL10_CONFIG_NAME=XXX_TST
SL10_USERNAME=api_user
SL10_PASSWORD=secret

# Data Lake (optional - if licensed)
LAKE_ENABLED=false
LAKE_COMPASS_URL=https://xxx.compass.infor.com
LAKE_ION_CLIENT_ID=xxx
LAKE_ION_CLIENT_SECRET=xxx

# Server
PORT=8100
LOG_LEVEL=INFO

# Volume thresholds
REST_PREFERRED_MAX=2000
REST_HARD_MAX=5000
```



## 9.3 Quick Reference



```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                          QUICK REFERENCE                                    â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  VOLUME LIMITS                                                              â”‚
â”‚  â€¢ REST optimal: < 2,000 records                                            â”‚
â”‚  â€¢ REST maximum: < 5,000 records                                            â”‚
â”‚  â€¢ Data Lake: > 10,000 records                                              â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  API ENDPOINTS                                                              â”‚
â”‚  â€¢ GET /bedrock/schedule          Production operations                     â”‚
â”‚  â€¢ GET /sales/orders              Open sales orders                         â”‚
â”‚  â€¢ GET /customers/search          Customer lookup                           â”‚
â”‚  â€¢ GET /inventory/status          Stock levels                              â”‚
â”‚  â€¢ GET /health                    System health                             â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  MCP TOOLS                                                                  â”‚
â”‚  â€¢ get_production_schedule        â†’ BedrockOpsScheduler                     â”‚
â”‚  â€¢ get_open_orders                â†’ SalesOrderTracker                       â”‚
â”‚  â€¢ search_customers               â†’ CustomerSearch                          â”‚
â”‚  â€¢ get_inventory_status           â†’ InventoryStatus                         â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  KEY METRICS                                                                â”‚
â”‚  â€¢ Target response time: < 2 seconds                                        â”‚
â”‚  â€¢ Token refresh: 55 minutes (before 60-min expiry)                         â”‚
â”‚  â€¢ Rate limit: ~1000 requests/minute                                        â”‚
â”‚  â€¢ Data Lake sync delay: 10-15 minutes                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



---



## Document History



| Version | Date | Changes |
|---------|------|---------|
| 1.0 | Dec 2024 | Initial REST API connector proposal |
| 2.0 | Dec 2024 | Added Data Lake analysis and hybrid architecture |
| 3.0 | Dec 2024 | Complete blueprint with MCP integration |



---



*KAI ERP Connector - Making ERP Data AI-Ready*

*Kaspar Companies IT Operations*

